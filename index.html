<!DOCTYPE html>
<html>
<head>
    <meta charset='utf-8'>
    <title>Rock-Paper-Scissors</title>
    <link rel="icon" type="image/png" href="favicon.png">
    <link rel="stylesheet" type="text/css" href="style.css">
</head>
<body>
    <h2 id="gameName">Rock, Paper, Scissors</h2>
    <p id="description">A classic game, with a modern touch. 
        Can you beat the computer?
    </p>
    <!-- <p id="instructions">(Right click > Inspect > Console)</p>  -->
    <button onclick="game()" id="start">Click here to start the game!</button>
    <div id="choice-buttons">
        <button class="choices rock">Rock</button>
        <button class="choices paper">Paper</button>
        <button class="choices scissors">Scissors</button>
    </div>
    <button id="end">Click here to end the game</button>
    <script>
        let playerWinCount = 0;
        let computerWinCount = 0;
        let roundCount = 0;
        let gameInProgress = false;
        let rock = document.querySelector(".rock");
        let paper = document.querySelector(".paper");
        let scissors = document.querySelector("scissors");

        function playRound() {
            function computerPlay() {
                let arr = ["Rock", "Paper", "Scissors"];
                let compChoice = arr[Math.floor(Math.random() * arr.length)];
                return compChoice;
            }

            function getPlayerChoice() {
                let str = prompt("Rock, Paper, or Scissors?");
                if (str) {
                    let newStr = str.toLowerCase();
                    let capStr = newStr[0].toUpperCase() + newStr.slice(1);
                    if (capStr === "Rock" || capStr === "Paper" || capStr === "Scissors") {
                        return capStr;
                    } else {
                        return;
                    }
                } else if (str === null) {
                    roundCount = 5;
                    playerWinCount = 5;
                    computerWinCount = 5;;
                } else {
                    return;
                }
            }

            let playerSelection = getPlayerChoice();
            let computerSelection = computerPlay();            

            if (playerSelection === computerSelection) {
                alert("Try again... You both chose " + playerSelection + "!");
                return;
            } else {
                if (playerSelection === "Rock") {
                    if (computerSelection === "Scissors") {
                        alert("You win! Rock beats Scissors!");
                        playerWinCount++;
                        roundCount++;
                        console.log("Player wins! Current score: Player-" +
                          playerWinCount + ", Computer-" + computerWinCount);
                        return;
                    } else if (computerSelection === "Paper") {
                        alert("You lose! Paper beats Rock!");
                        computerWinCount++;
                        roundCount++;
                        console.log("Computer wins! Current score: Player-" +
                          playerWinCount + ", Computer-" + computerWinCount);
                        return;
                    }
                } else if (playerSelection === "Paper") {
                    if (computerSelection === "Rock") {
                        alert("You win! Paper beats Rock!");
                        playerWinCount++;
                        roundCount++;
                        console.log("Player wins! Current score: Player-" +
                          playerWinCount + ", Computer-" + computerWinCount);
                        return;
                    } else if (computerSelection === "Scissors") {
                        alert("You lose! Scissors beats Paper!");
                        computerWinCount++;
                        roundCount++;
                        console.log("Computer wins! Current score: Player-" +
                          playerWinCount + ", Computer-" + computerWinCount);
                        return;
                    }
                } else if (playerSelection === "Scissors") {
                    if (computerSelection === "Rock") {
                        alert("You lose! Rock beats Scissors!");
                        computerWinCount++;
                        roundCount++;
                        console.log("Computer wins! Current score: Player-" +
                          playerWinCount + ", Computer-" + computerWinCount);
                        return;
                    } else if (computerSelection === "Paper") {
                        alert("You win! Scissors beats Paper!");
                        playerWinCount++;
                        roundCount++;
                        console.log("Player wins! Current score: Player-" +
                          playerWinCount + ", Computer-" + computerWinCount);
                        return;
                    }
                }
            }
        }

        function game() {
            gameInProgress = true;
            console.log("Let's play Rock, Paper, Scissors!");
            while (roundCount < 5) {
                playRound();
                let gameOver = false;
            }
            if (playerWinCount > computerWinCount) {
                alert("Player wins! The score was " + playerWinCount + " - " +
                  computerWinCount + ".");
            } else if (computerWinCount > playerWinCount) {
                alert("Computer wins! The score was " + computerWinCount + " - " +
                  playerWinCount + ".");
            } else {
                alert("Something crazy happened and I have no idea who won!");
            }
            gameOver = true;
            
            if (gameOver) {
                playerWinCount = 0;
                computerWinCount = 0;
                roundCount = 0;
            }
        }

    </script>
</body>
</html>